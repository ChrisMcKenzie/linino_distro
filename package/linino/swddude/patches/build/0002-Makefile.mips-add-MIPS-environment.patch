From 0c44e8d2b15ed6d3dba2987757f55db7ba51a108 Mon Sep 17 00:00:00 2001
From: Federico Vaga <federico.vaga@gmail.com>
Date: Tue, 3 Dec 2013 17:28:09 +0100
Subject: [PATCH 2/2] Makefile.mips: add MIPS environment

Signed-off-by: Federico Vaga <federico.vaga@gmail.com>
---
 Makefile.mips  | 42 ++++++++++++++++++++++++++++++++++++++++++
 Makefile.rules |  6 ++++++
 2 files changed, 48 insertions(+)
 create mode 100644 Makefile.mips

diff --git a/Makefile.mips b/Makefile.mips
new file mode 100644
index 0000000..91568ff
--- /dev/null
+++ b/Makefile.mips
@@ -0,0 +1,42 @@
+# -*- mode: makefile; -*-
+#
+# Copyright (c) 2011, Anton Staaf
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#     * Redistributions of source code must retain the above copyright
+#       notice, this list of conditions and the following disclaimer.
+#     * Redistributions in binary form must reproduce the above copyright
+#       notice, this list of conditions and the following disclaimer in the
+#       documentation and/or other materials provided with the distribution.
+#     * Neither the name of the project nor the names of its contributors
+#       may be used to endorse or promote products derived from this software
+#       without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDERS BE LIABLE FOR ANY
+# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+# ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+#
+CROSS_COMPILE ?= mips-
+
+__tool_prefix		:= $(CROSS_COMPILE)
+__tool_gcc_hack		:= gcc
+
+__tool_lflags		:= -Wl,--gc-sections,--relax
+ifdef STAGING_DIR
+__tool_lflags		+= -L $(STAGING_DIR)/target-mips_r2_uClibc-0.9.33.2/usr/lib/
+endif
+__tool_lflags		+= -lstdc++
+
+#__tool_lflags[profile]	:= -pg
+#__tool_lflags[coverage]	:= -fprofile-arcs -ftest-coverage
+
+#__root_directory	:= mips
diff --git a/Makefile.rules b/Makefile.rules
index 8c69b05..14cdaac 100644
--- a/Makefile.rules
+++ b/Makefile.rules
@@ -26,6 +26,12 @@
 # THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 #
 
+ARCH ?= native
+
+ifneq ($(ARCH), native)
+	include $(depth)/build/Makefile.$(ARCH)
+endif
+
 $(if $(filter undefined,$(origin depth)),\
      $(error You must set 'depth' in your makefile.  It must be a relative\
 	path to the root of the source tree.))
-- 
1.8.3.1

